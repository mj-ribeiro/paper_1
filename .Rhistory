legend = T,
names.arg = texto)
barplot(vf,
col="darkred",
ylim = c( 0, 100),
width = 1,
legend = T,
names.arg = texto,
horiz = T)
barplot(vf,
col="darkred",
ylim = c( 0, 100),
width = 1,
legend = T,
names.arg = texto)
barplot(vf,
main = 'Quanto tempo para chegar ao Milhão',
ylab = 'Meses',
xlab = 'Taxa de juros mensal',
col="darkred",
ylim = c( 0, 100),
width = 1,
legend = T,
names.arg = texto)
barplot(vf,
main = 'Quanto tempo para chegar ao Milhão investindo R$1000 por mês',
ylab = 'Meses',
xlab = 'Taxa de juros mensal',
col="darkred",
ylim = c( 0, 100),
width = 1,
legend = T,
names.arg = texto)
barplot(vf,
main = 'Quanto tempo para chegar a um Milhão investindo R$1000 por mês',
ylab = 'Meses',
xlab = 'Taxa de juros mensal',
col="darkred",
ylim = c( 0, 100),
width = 1,
legend = T,
names.arg = texto)
txs = (1 + txs)^(1/12) - 1
vf = fut(1000, 1e6, txs)
texto = as.character(txs*100)
texto = paste(texto,'%')
barplot(vf,
main = 'Quanto tempo para chegar a um Milhão investindo R$1000 por mês',
ylab = 'Meses',
xlab = 'Taxa de juros mensal',
col="darkred",
ylim = c( 0, 100),
width = 1,
legend = T,
names.arg = texto)
barplot(vf,
main = 'Quanto tempo para chegar a um Milhão investindo R$1000 por mês',
ylab = 'Meses',
xlab = 'Taxa de juros mensal',
col="darkred",
#  ylim = c( 0, 100),
width = 1,
legend = T,
names.arg = texto)
txs
round(txs, 2)
round(txs, 4)
round(txs, 3)
round(txs, 4)
round(txs*100, 4)
round(txs*100, 2)
txs = round(txs*100, 2)
txs = round(txs*100, 1)
txs
txs = round(txs*100, 2)
txs
txs = seq(0.04, 0.20, 0.01)
txs = (1 + txs)^(1/12) - 1
txs = round(txs*100, 1)
txs
texto = as.character(txs*100)
texto = paste(texto,'%')
barplot(vf,
main = 'Quanto tempo para chegar a um Milhão investindo R$1000 por mês',
ylab = 'Meses',
xlab = 'Taxa de juros mensal',
col="darkred",
#  ylim = c( 0, 100),
width = 1,
legend = T,
names.arg = texto)
texto = as.character(txs)
texto = paste(texto,'%')
barplot(vf,
main = 'Quanto tempo para chegar a um Milhão investindo R$1000 por mês',
ylab = 'Meses',
xlab = 'Taxa de juros mensal',
col="darkred",
#  ylim = c( 0, 100),
width = 1,
legend = T,
names.arg = texto)
barplot(vf,
main = 'Quanto tempo para chegar a um Milhão investindo R$1000 por mês',
ylab = 'Meses',
xlab = 'Taxa de juros mensal',
col="darkred",
ylim = c( 0, 500),
width = 1,
legend = T,
names.arg = texto)
450/12
barplot(vf/12,
main = 'Quanto tempo para chegar a um Milhão investindo R$1000 por mês',
ylab = 'Meses',
xlab = 'Taxa de juros mensal',
col="darkred",
ylim = c( 0, 500/12),
width = 1,
legend = T,
names.arg = texto)
barplot(vf,
main = 'Quanto tempo para chegar a um Milhão investindo R$1000 por mês',
ylab = 'Meses',
xlab = 'Taxa de juros mensal',
col="darkred",
ylim = c( 0, 500),
width = 1,
legend = T,
names.arg = texto)
fut = function(r, s, i){
log((s*i)/r + 1 )/ log(1 + i)
}
txs = seq(0.04, 0.20, 0.01)
txs = (1 + txs)^(1/12) - 1
txs = seq(0.02, 0.20, 0.01)
tx_anual = seq(0.02, 0.20, 0.01)
tx_mensal = (1 + txs)^(1/12) - 1
tx_mensal = round(tx_mensal*100, 1)
vf = fut(1000, 1e6, tx_mensal)
plot(txs,vf, type='l',
ylim = c( min(vf), max(vf) ),
xlab = 'Taxas de juros',
ylab = 'Meses')
texto = as.character(tx_mensal)
texto = paste(texto,'%')
barplot(vf,
main = 'Quanto tempo para chegar a um Milhão investindo R$1000 por mês',
ylab = 'Meses',
xlab = 'Taxa de juros mensal',
col="darkred",
ylim = c( 0, 500),
width = 1,
legend = T,
names.arg = texto)
tx_mensal = (1 + txs)^(1/12) - 1
tx_anual = seq(0.02, 0.20, 0.01)
tx_mensal = (1 + tx_anual)^(1/12) - 1
tx_mensal = round(tx_mensal*100, 2)
vf = fut(1000, 1e6, tx_mensal)
fut(1000, 1e6, tx_mensal)
barplot(vf,
main = 'Quanto tempo para chegar a um Milhão investindo R$1000 por mês',
ylab = 'Meses',
xlab = 'Taxa de juros mensal',
col="darkred",
ylim = c( 0, 500),
width = 1,
legend = T,
names.arg = texto)
barplot(vf,
main = 'Quanto tempo para chegar a um Milhão investindo R$1000 por mês',
ylab = 'Meses',
xlab = 'Taxa de juros mensal',
col="darkred",
# ylim = c( 0, 500),
width = 1,
legend = T,
names.arg = texto)
fut = function(r, s, i){
log((s*i)/r + 1 )/ log(1 + i)
}
fut(1000, 1e6, 0.1)
fut(359, 7552.5, 0.05)
fut(350, 7552.5, 0.05)
1e6
fut(1000, 1000000, 0.1)
tx_anual = seq(0.02, 0.20, 0.01)
tx_mensal = (1 + tx_anual)^(1/12) - 1
vf = fut(1000, 1e6, tx_mensal)
plot(txs,vf, type='l',
ylim = c( min(vf), max(vf) ),
xlab = 'Taxas de juros',
ylab = 'Meses')
barplot(vf,
main = 'Quanto tempo para chegar a um Milhão investindo R$1000 por mês',
ylab = 'Meses',
xlab = 'Taxa de juros mensal',
col="darkred",
# ylim = c( 0, 500),
width = 1,
legend = T,
names.arg = texto)
texto = as.character(round(tx_mensal*100, 2))
texto = paste(texto,'%')
vf = fut(1000, 1e6, tx_mensal)
barplot(vf,
main = 'Quanto tempo para chegar a um Milhão investindo R$1000 por mês',
ylab = 'Meses',
xlab = 'Taxa de juros mensal',
col="darkred",
# ylim = c( 0, 500),
width = 1,
legend = T,
names.arg = texto)
barplot(vf,
main = 'Quanto tempo para chegar a um Milhão investindo R$1000 por mês',
ylab = 'Meses',
xlab = 'Taxa de juros mensal',
col="darkred",
ylim = c( 0, 600),
width = 1,
legend = T,
names.arg = texto)
texto2 = as.character(tx_anual)
texto2 = paste(texto2,'%')
barplot(vf/12,
main = 'Quanto tempo para chegar a um Milhão investindo R$1000 por mês',
ylab = 'Meses',
xlab = 'Taxa de juros mensal',
col="darkred",
ylim = c( 0, 600),
width = 1,
legend = T,
names.arg = texto2)
barplot(vf/12,
main = 'Quanto tempo para chegar a um Milhão investindo R$1000 por mês',
ylab = 'Meses',
xlab = 'Taxa de juros mensal',
col="darkred",
#ylim = c( 0, 600),
width = 1,
legend = T,
names.arg = texto2)
texto2 = as.character(tx_anual*100)
texto2 = paste(texto2,'%')
barplot(vf/12,
main = 'Quantos anos para chegar a um Milhão investindo R$1000 por mês',
ylab = 'Anos',
xlab = 'Taxa de juros anual',
col="darkred",
#ylim = c( 0, 600),
width = 1,
legend = T,
names.arg = texto2)
barplot(vf/12,
main = 'Quantos anos para chegar a um Milhão investindo R$1000 por mês',
ylab = 'Anos',
xlab = 'Taxa de juros anual',
col="darkred",
ylim = c( 0, 60),
width = 1,
legend = T,
names.arg = texto2)
barplot(vf,
main = 'Quanto meses para chegar a um Milhão investindo R$1000 por mês',
ylab = 'Meses',
xlab = 'Taxa de juros mensal',
col="darkred",
ylim = c( 0, 600),
width = 1,
legend = T,
names.arg = texto)
barplot(vf,
main = 'Quanto meses para chegar a um Milhão investindo R$1000 por mês',
ylab = 'Meses',
xlab = 'Taxa de juros mensal',
col="darkred",
ylim = c(0, 600),
width = 1,
#legend = T,
names.arg = texto)
barplot(vf/12,
main = 'Quantos anos para chegar a um Milhão investindo R$1000 por mês',
ylab = 'Anos',
xlab = 'Taxa de juros anual',
col  = "darkred",
ylim = c( 0, 60),
width = 1,
names.arg = texto2)
fut(1000, 1e6, tx_mensal)
fut(1000, 1e6, 0.05)
fut(1000, 1e6, 0.005)
vf = fut(1000, 1e6, tx_mensal)
barplot(vf/12,
main = 'Quantos anos para chegar a um Milhão investindo R$1000 por mês',
ylab = 'Anos',
xlab = 'Taxa de juros anual',
col  = "darkred",
ylim = c( 0, 60),
width = 1,
names.arg = texto2)
barplot(vf/12,
main = 'Quantos anos para chegar a um Milhão investindo R$1000 por mês',
cex = 1,
ylab = 'Anos',
xlab = 'Taxa de juros anual',
col  = "darkred",
ylim = c( 0, 60),
width = 1,
names.arg = texto2)
barplot(vf/12,
main = 'Quantos anos para chegar a um Milhão investindo R$1000 por mês',
cex.lab = 1,
ylab = 'Anos',
xlab = 'Taxa de juros anual',
col  = "darkred",
ylim = c( 0, 60),
width = 1,
names.arg = texto2)
barplot(vf/12,
main = 'Quantos anos para chegar a um Milhão investindo R$1000 por mês',
cex.lab = 2,
ylab = 'Anos',
xlab = 'Taxa de juros anual',
col  = "darkred",
ylim = c( 0, 60),
width = 1,
names.arg = texto2)
barplot(vf/12,
main = 'Quantos anos para chegar a um Milhão investindo R$1000 por mês',
cex.lab = 1.5,
ylab = 'Anos',
xlab = 'Taxa de juros anual',
col  = "darkred",
ylim = c( 0, 60),
width = 1,
names.arg = texto2)
barplot(vf/12,
main = 'Quantos anos para chegar a um Milhão investindo R$1000 por mês',
cex.lab = 1.5,
cex.main = 1.5,
ylab = 'Anos',
xlab = 'Taxa de juros anual',
col  = "darkred",
ylim = c( 0, 60),
width = 1,
names.arg = texto2)
barplot(vf/12,
main = 'Quantos anos para chegar a um Milhão investindo R$1000 por mês',
cex.lab = 2,
cex.main = 2,
ylab = 'Anos',
xlab = 'Taxa de juros anual',
col  = "darkred",
ylim = c( 0, 60),
width = 1,
names.arg = texto2)
barplot(vf/12,
main = 'Quantos anos para chegar a um Milhão investindo R$1000 por mês',
cex.lab = 2,
cex.main = 2,
cex.axis = 2,
ylab = 'Anos',
xlab = 'Taxa de juros anual',
col  = "darkred",
ylim = c( 0, 60),
width = 1,
names.arg = texto2)
barplot(vf/12,
main = 'Quantos anos para chegar a um Milhão investindo R$1000 por mês',
cex.lab = 2,
cex.main = 2,
cex.axis = 2,
ylab = 'Anos',
xlab = 'Taxa de juros anual',
col  = "darkred",
ylim = c( 0, 60),
width = 1,
names.arg = texto2,
cex.names = 2)
barplot(vf/12,
main = 'Quantos anos para chegar a um Milhão investindo R$1000 por mês',
cex.lab = 2,
cex.main = 2,
cex.axis = 2,
ylab = 'Anos',
xlab = 'Taxa de juros anual',
col  = "darkred",
ylim = c( 0, 60),
width = 1,
names.arg = texto2,
cex.names = 1.5)
barplot(vf/12,
main = 'Quantos anos para chegar a um Milhão investindo R$1000 por mês',
cex.lab = 2,
cex.main = 2,
cex.axis = 2,
ylab = 'Anos',
xlab = 'Taxa de juros anual',
col  = "darkred",
ylim = c( 0, 60),
width = 1,
names.arg = texto2,
cex.names = 1.2)
barplot(vf/12,
main = 'Quantos anos para chegar a um Milhão investindo R$1000 por mês',
ylab = 'Anos',
xlab = 'Taxa de juros anual',
col  = "darkred",
ylim = c( 0, 60),
width = 1,
names.arg = texto2)
setwd("C:/Users/user/Downloads/Thesis_paper_1/calibration")
# libraries ----
library(readxl)
library(tidyverse)
library(dplyr)
library(fGarch)
library(magrittr)
library(haven)
d = function(x){                   # usar o in ao invés do ==
k = ifelse(x==1, 1,
ifelse(x %in% c(2, 3, 4), 2,
ifelse(x %in% seq(4,9, 1), 3, 0)
))
return(k)
}
# inpc ----
library(readxl)
inpc = read_excel("inpc.xlsx")
inpc = data.frame(inpc)
# Deflator ----
# minimo 1995 = 100
defla = inpc[inpc$ano==1995, 'd10']
w_min = 100*defla
hr_trab = (252*8)/12  # 252 days  8 hours worked  12 months  hour worked per month
r25 = (0.25*w_min)/hr_trab
pnad95 <- read_dta("D:/PNADs/PNAD_DATAZOOM/pnad1995pes.dta")
pnad95 = pnad95 %>%
add_column(new = 1)
pnad95 =  pnad95 %>%
dplyr::mutate(v4718 = (v4718/1000)/2750)  # converter to real
pnad95 <- read_dta("D:/PNADs/PNAD_DATAZOOM/pnad1995pes.dta")
pnad95 = pnad95 %>%
add_column(new = 1)
pnad95 =  pnad95 %>%
dplyr::mutate(s_hora = (v4718*defla)/hr_trab)
pnad92 = pnad92 %>%
dplyr::mutate(my_code = d(v4716))
pnad95 = pnad95 %>%
dplyr::mutate(my_code = d(v4716))
pnad95 = pnad95 %>%
dplyr::filter(v4706 != 2 &                      # remove military
v4716 != 10 &                   # remove public administration
my_code !=0 &                   # remove NAs
s_hora > r25 &                   # rule 25%
v4718 < 999999999999)           #
anos_est =pnad95 %>%
group_by(my_code) %>%
dplyr::summarise( weighted.mean(v4703,
w = v4729,
na.rm = TRUE) )
W_i = pnad95 %>%
group_by(my_code) %>%
summarise(weighted.mean(s_hora,
w = v4729,
na.rm=T))
soma = pnad95 %>%
group_by(my_code) %>%
count(new, wt = v4729) %>%
summarise(n)
p_i = soma %>%
summarise(pi = n/sum(soma$n))
anos_est[1] = NULL
W_i[1] = NULL
colnames(anos_est) = c( 'anos_est')
colnames(W_i) = c('W_i')
colnames(p_i) = c('p_i')
data.frame(anos_est, W_i, p_i)
eta = 0.25
beta = 0.69
c = (1-eta)/beta
s = 0.24*(anos_est/25)
phi = c*s/(1-s)
phi
colnames(phi) = 'phi'
library(readxl)
pibs = read_excel('pibs_set.xls', sheet = 's1')
pibs = data.frame(pibs)
head(pibs)
alfa95 = pibs[pibs$Data==1995, 1:sec+1]/pibs[pibs$Data==1995, sec+2 ]
# load pibs ----
sec = 3
alfa95 = pibs[pibs$Data==1995, 1:sec+1]/pibs[pibs$Data==1995, sec+2 ]
alfa95
library(data.table)
alfa95 = transpose(alfa95)
colnames(alfa95) = c('alfa95')
ocp = c('AGR', 'IND', 'SEV')
df = data.frame(W_i, p_i, anos_est, phi, alfa95)
df
row.names(df) = ocp
df
library("xlsx")
write.xlsx(df, file='data_95.xlsx')
eta = 0.103
beta = 0.231
c = (1-eta)/beta
s = 0.24*(anos_est/25)
phi = c*s/(1-s)
phi
